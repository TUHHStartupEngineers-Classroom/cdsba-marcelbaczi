{
  "hash": "5f36803abf2d47c496debb11d014d187",
  "result": {
    "markdown": "---\ntitle: \"Directed Acyclic Graphs\"\n---\n\n\n# Assignment 1\n\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-1_1d2d134b096ab26019a2aeb372bcb2f6'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.4     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.2     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(dagitty)\n#library(ggthemr) package ‘ggthemr’ is not available for this version of R\nlibrary(ggdag)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'ggdag'\n#> \n#> The following object is masked from 'package:stats':\n#> \n#>     filter\n```\n:::\n\n```{.r .cell-code}\ndag_model <- 'dag {\nbb=\"-3,-3,3,3\"\nSales [outcome,pos=\"2.000,0.000\"]\nStore1 [pos=\"-2.000,2.000\"]\nStore2 [pos=\"-2.000,1.000\"]\nStore3 [pos=\"-2.000,-1.000\"]\nStore4 [pos=\"-2.000,-2.000\"]\nparkingspots [exposure,pos=\"0.000,0.000\"]\nStore1 -> parkingspots\nStore2 -> parkingspots\nStore3 -> parkingspots\nStore4 -> parkingspots\nparkingspots -> Sales\n}\n'\n# draw DAG\nggdag(dag_model);\n```\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n# Assignment 2\n\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-2_bf06a4f82523a9088c996ab5eb756491'}\n\n```{.r .cell-code}\ndata <- readRDS(\"C:/Users/Marcel/Master/DataScience/data/customer_sat.rds\")\nprint(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> # A tibble: 15 × 3\n#>    follow_ups satisfaction subscription\n#>         <dbl>        <dbl> <chr>       \n#>  1          8           40 Elite       \n#>  2          7           45 Elite       \n#>  3          8           47 Elite       \n#>  4          9           44 Elite       \n#>  5         10           50 Elite       \n#>  6          6           55 Premium+    \n#>  7          7           60 Premium+    \n#>  8          6           62 Premium+    \n#>  9          8           59 Premium+    \n#> 10          8           65 Premium+    \n#> 11          0           70 Premium     \n#> 12          1           74 Premium     \n#> 13          2           77 Premium     \n#> 14          2           74 Premium     \n#> 15          3           80 Premium\n```\n:::\n\n```{.r .cell-code}\nreg1 <- lm(satisfaction ~ follow_ups, data = data)\nsummary(reg1,digits = 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satisfaction ~ follow_ups, data = data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -12.412  -5.257   1.733   4.506  12.588 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  78.8860     4.2717  18.467 1.04e-10 ***\n#> follow_ups   -3.3093     0.6618  -5.001 0.000243 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 7.923 on 13 degrees of freedom\n#> Multiple R-squared:  0.658,\tAdjusted R-squared:  0.6316 \n#> F-statistic: 25.01 on 1 and 13 DF,  p-value: 0.0002427\n```\n:::\n\n```{.r .cell-code}\nreg2 <- lm(satisfaction ~ ., data = data)\nsummary(reg2,digits = 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satisfaction ~ ., data = data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -4.3222 -2.1972  0.3167  2.2667  3.9944 \n#> \n#> Coefficients:\n#>                      Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)           26.7667     6.6804   4.007  0.00206 ** \n#> follow_ups             2.1944     0.7795   2.815  0.01682 *  \n#> subscriptionPremium   44.7222     5.6213   7.956 6.88e-06 ***\n#> subscriptionPremium+  18.0722     2.1659   8.344 4.37e-06 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 2.958 on 11 degrees of freedom\n#> Multiple R-squared:  0.9597,\tAdjusted R-squared:  0.9487 \n#> F-statistic: 87.21 on 3 and 11 DF,  p-value: 5.956e-08\n```\n:::\n:::\n\n\n# Assignment 3\n\nThe difference between the coefficients shows that the satisfaction due to follow ups is influenced by the subscription level of the clients.\n\nNot accounting for the subscription level would indicate that the follow up calls decrease satisfaction level. Accounting for the subscription level shows that this is not the case. This could indicate that customers that pay for higher subscription levels expect follow up calls for the price they pay while some lower paying customers might find it more annoying.\n\nAnother important point is that we do not have a lot of data. The range of follow up calls is different for each type of subscription. While the Premium subscribers are on average the most satisfied according to this data they are also the ones called the least. The results might change if they get called as much as the other groups.\n\n# Assignment 4\n\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-3_8902a912dcc1e1f9d12a1fade4651664'}\n\n```{.r .cell-code}\n#Satisfaction not conditioned on subscription level\nsat_not_cond <- ggplot(data,aes(x = satisfaction, y = follow_ups))+\n  geom_point()+\n  stat_smooth(method = \"lm\", se = F)\n\n#Satisfaction conditioned on subscription level\nsat_cond <- ggplot(data,aes(x = satisfaction, y = follow_ups, group=subscription, color=subscription))+\n  geom_point()+\n  stat_smooth(method = \"lm\", se = F)\n\nsat_not_cond\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsat_cond\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}